## Determining the new version and drafting the release notes

The two most important bits of metadata about a release is the *new version number* and the *release
notes*. While we have tooling to help, your job is to make sure these are correct. If you're not
familiar with [MDC's version number policy](versions.md), please review it now.

To figure out the release number you will need to examine the release's changes.

You have several tools available for deciding if a release is major, minor, or a patch.

### Review the API diff

CHANGELOG.md automatically includes the latest set of public API changes as part of the `cut` command.
Inspect the API changes to get a quick sense of whether there might be an API-breaking change.

1. If any part of a public API is deleted or changed, then this release is a *major* release.
1. If any public API's nullability annotations have changed then this release is a *major* release.
1. Otherwise, if any public APIs added, then this release is a *minor* release.
1. Otherwise, this release *might* still be a bug fix release.

### New Features / Top Level Description 

In the "New Features" sub-category generated by the API diff tool, please provide more detail as to what is new in the release, also providing examples on how to use the added public API properties/methods. For instance if you have added the method `setShadowWidth:` to `MDCCard` an example usage would be:
```swift
let card = MDCCard()
card.setShadowWidth(10)
```

In the top level description please provide a sentence explaining the overall release. Something along the lines of:
"This minor/major/patch release includes X and Y along with some Z."

### Verify API changes

While we do primarily lean on the api_diff tool to call out API diffs, it isn't perfect.  For each
API change, open the source at the latest checkout and verify that the API change does, in fact,
reflect the change that occurred.

Adjust the API diffs in CHANGELOG.md based on your visual inspection of the code.

Commit the final results to your branch.

    git add CHANGELOG.md
    git commit -m "Hand-modified CHANGELOG.md API diff."
    git push origin release-candidate

### Identify visual changes

We do not presently have an automated way to identify visual changes between releases. See [GitHub
issue #290](https://github.com/material-components/material-components-ios/issues/290) for a
discussion on the topic.

### [Optional] Sanity check: inspect the changes

#### Diff just the components

The final sanity check is to visually inspect the diff.

> If you have configured Git with a GUI diff tool (`git difftool`) like [Kaleidoscope](https://itunes.apple.com/us/app/kaleidoscope/id587512244?mt=12), then you can add
> `--use_diff_tool` to `scripts/release diff` below.

Generate a list of component public header changes:

    scripts/release headers

Show changes to component headers:

    scripts/release diff components/*/src/*.h

Show all changes to components:

    scripts/release diff components/*/src/

#### Diff everything

Show all changes that are part of this release:

    scripts/release diff

### Classify the release type

You should now be able to identify the release type and its new version number. Bump the release
(change the version number everywhere):

    scripts/release bump <major.minor.patch>

Commit the results to your branch:

    git commit -am "Bumped version number to $(scripts/print_version)."
    git push origin release-candidate
    
Update the PR title to the release version. The format is typically "vX.Y.Z" (*e.g.*, v72.0.1). 
Once this is done, send the PR out for review. Add "material-components/core-ios-team" to the 
list of Reviewers. Also add anyone else you think might need to review specific changes in the 
release candidate.

## Consider running `scripts/release notes` again

Run `scripts/release notes` again and copy paste it into the `CHANGELOG.md` after `## Changes` if
you

* cherry picked a change to add it to the release or
* reverted any commit to rollback any PR.

## Testing with release-blocking clients

Before you can merge the release branch into either develop or stable you **must** get the release
go-ahead from the following clients:

- Google: must verify that the release branch passes all internal tests. If you are a Googler, see
  the internal "mirroring" document for further instructions. Notably you **must not continue** this
  releasing process until the internal synchronization CL has been tested.

---

               |\___/|
              (,\  /,)\
              /     /  \       DRAGON SAYS HALT:
             (@_^_@)/   \      READ THE ABOVE SECTION BEFORE CONTINUING.
              W//W_/     \     DO NOT MERGE OR CUT ANY RELEASES UNTIL
            (//) |        \    YOU'VE DONE SO.
          (/ /) _|_ /   )  \
        (// /) '/,_ _ _/  (~^-.
      (( // )) ,-{        _    `.
     (( /// ))  '/\      /       \
     (( ///))     `.   {       }  \
      ((/ ))    .----~-.\   \-'    ~-__
               ///.----..>   \ \_      ~--____
                ///-._ _  _ _}    ~--------------

---